--- chromium-browser-7.0.510.0~svn20100831r57933/src/chrome/browser/search_engines/template_url.cc~	2010-08-31 17:24:46.000000000 +0300
+++ chromium-browser-7.0.510.0~svn20100831r57933/src/chrome/browser/search_engines/template_url.cc	2010-09-01 22:28:29.663788855 +0300
@@ -337,27 +337,28 @@
        i != replacements_.rend(); ++i) {
     switch (i->type) {
       case ENCODING:
-        url.insert(i->index, input_encoding);
+        /* Temporary workaround according to http://crbug.com/41887 */
+        url.replace(i->index, 0, input_encoding);
         break;
 
       case GOOGLE_ACCEPTED_SUGGESTION:
         if (accepted_suggestion == NO_SUGGESTION_CHOSEN)
-          url.insert(i->index, "aq=f&");
+          url.replace(i->index, 0, "aq=f&");
         else if (accepted_suggestion != NO_SUGGESTIONS_AVAILABLE)
-          url.insert(i->index, StringPrintf("aq=%d&", accepted_suggestion));
+          url.replace(i->index, 0, StringPrintf("aq=%d&", accepted_suggestion));
         break;
 
       case GOOGLE_BASE_URL:
-        url.insert(i->index, search_terms_data.GoogleBaseURLValue());
+        url.replace(i->index, 0, search_terms_data.GoogleBaseURLValue());
         break;
 
       case GOOGLE_BASE_SUGGEST_URL:
-        url.insert(i->index, search_terms_data.GoogleBaseSuggestURLValue());
+        url.replace(i->index, 0, search_terms_data.GoogleBaseSuggestURLValue());
         break;
 
       case GOOGLE_ORIGINAL_QUERY_FOR_SUGGESTION:
         if (accepted_suggestion >= 0)
-          url.insert(i->index, "oq=" + UTF16ToUTF8(encoded_original_query) +
+          url.replace(i->index, 0, "oq=" +UTF16ToUTF8(encoded_original_query) +
                                "&");
         break;
 
@@ -381,17 +382,17 @@
         base::WideToCodepage(terms, input_encoding.c_str(),
                              base::OnStringConversionError::SKIP,
                              &unescaped_terms);
-        url.insert(i->index, std::string(unescaped_terms.begin(),
+        url.replace(i->index, 0, std::string(unescaped_terms.begin(),
                                          unescaped_terms.end()));
         break;
       }
 
       case LANGUAGE:
-        url.insert(i->index, search_terms_data.GetApplicationLocale());
+        url.replace(i->index, 0, search_terms_data.GetApplicationLocale());
         break;
 
       case SEARCH_TERMS:
-        url.insert(i->index, UTF16ToUTF8(encoded_terms));
+        url.replace(i->index, 0, UTF16ToUTF8(encoded_terms));
         break;
 
       default:
